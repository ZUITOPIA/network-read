### Chap6. 웹 사이트 & 이메일의 구조 이해하기

### 01. 웹 사이트에 접속해보자

```
정적 웹 사이트 (웹 서버 내에 미리 만들어져 있는 페이지)
-> ex. http://www.n-study.com/

동적 웹 사이트 (검색 결과에 따라 새로 만들어지는 페이지)
-> 주소 부분에 검색 키워드인 'HTTP'가 포함되어 있음

웹 페이지의 소스 열어보기
-> 웹 페이지는 HTML로 작성되어 있으며, 텍스트의 폰트나 페이지 요소의 위치 등이 저장되어 있음
-> 페이지 소스 보기 메뉴 클릭으로 HTML소스 내용 확인 가능

쿠키가 저장된 폴더 열어보기
-> 웹 서버는 '쿠키'라는 파일을 생성하여 접속한 유저의 정보를 웹 브라우저에 저장함
-> 윈도우 기준 '도구'메뉴 > '인터넷 옵션' > '일반' > '설정' > '웹사이트의 데이터 설정' > '파일 보기'

쿠키 파일 확인하기
-> 쿠키가 저장된 폴더를 열어보면 cookie로 시작하는 텍스트 파일(쿠키 파일)이 존재함
-> 무언가의 정보들이 쿠키로 저장된다는 사실 확인은 가능하지만, 쿠키 파일의 내용은 웹 서버 쪽에서 정한 것이라 유저가 내용을 본다해도 그 내용이 무엇을 의미하는지는 알기 힘듦
```

### 01-1. '웹 사이트를 보는' 것은 무엇을 의미할까?

웹 사이트를 열어보는 것
= 웹 서버로부터 HTML 파일이나 이미지 파일 등을 다운로드 하여 표시하는 것
= 웹 엑세스 = HTML 파일이나 이미지 파일에 엑세스함

웹 엑세스에 이용하는 애플리케이션 > '인터넷 익스플로러', '크롬'
웹 사이트의 내용을 기술하기 위해 사용되는 언어 > HTML
웹 서버로부터 파일을 올바르게 전송받기 위해 사용되는 프로토콜 > HTTP

> 주의, 통신하는 웹 서버는 1대 뿐만이 아님!

### 01-1-1. 웹 엑세스의 전체적인 흐름 (5단계)

1.  유저가 웹 브라우저에 URL을 입력한다.
2.  URL로 지정한 웹 서버에게 HTTP 요청을 송신한다.
3.  웹 서버가 요청을 해석한다.
4.  웹 서버가 요청받은 파일을 웹 브라우저에 돌려보낸다.
5.  웹 브라우저가 수신한 데이터를 해석해서 표시한다.

### 01-1-2. URL의 구조

예시 : http://www.n-study.com/network/index.html

```
http, https, ftp => 스킴(scheme)
:의 뒷부분 => 데이터의 위치
//의 뒷부분인 www.n-study.com => 호스트명
(호스트명 뒤에는 주로 포트 번호가 오게 되어있지만, 보통 생략함)
호스트명의 뒷부분, 목적 데이터가 웹 서버 내 어디에 있는지 가리키는 network/index.html => 패스
```

### 01-1-3. 정적 웹 페이지와 동적 웹 페이지

정적 웹 페이지 : 사전에 저자가 작성해서 웹 서버에 저장해둔 것
(인터넷 상에 존재하는 수많은 공식 기업 사이트 / 개인 사이트)

동적 웹 페이지 : 웹 브라우저의 요청에 따라서 웹 서버가 자동으로 생성한 웹 페이지
(클라이언트 측의 정보나 입력한 파라미터(검색 키워드) 등이 URL에 포함되기 때문에 URL이 매우 길어짐)

### 01-2. HTML이 뭐지?

HTML = 웹 페이지 내용

### 01-3. HTTP가 뭐지?

웹 페이지 : HTML로 쓰여진 HTML 파일과 HTML 파일 내에서 불러오는 이미지 파일 등으로 구성됨

HTTP (HyperText Transfer Protocol)
=> 웹 서버에 존재하는 HTML 파일이나 이미지 파일을 PC의 웹 브라우저로 전송하기 위해 이용되는 것
=> HTTP 프로토콜을 사용한 파일 전송 : HTTP 요청 - HTTP 응답 주고 받음

```
웹 브라우저가 웹 서버로 보내는 HTTP 요청
=> 요청 행(Request Line) + 메세지 헤더(Message Header) + 엔티티 바디(Entity Body)

요청 행은 '메소드', 'URI', '버전'으로 구성되어 있음
> 메소드 : 서버에 대한 요구 커맨드 (GET, HEAD, POST, PUT)

메시지 헤더
> 요청 행 다음에 오는 여러 행의 문자열
> 웹 브라우저의 종류, 버전, 데이터 형식 등의 정보가 쓰여 있음

엔티티 바디
> 파일을 보낼 때 사용 (보낼 데이터가 없는 경우에는 사용 X)
```

HTTP 요청 행의 메소드

| 메소드 |                        의미                         |
| :----: | :-------------------------------------------------: |
|  GET   |           URI로 지정한 데이터를 가져온다            |
|  HEAD  |    URI로 지정한 데이터의 응답 헤더만을 가져온다     |
|  POST  | URI로 지정한 서버의 커맨드에 대해 데이터를 송신한다 |
|  PUT   |   URI로 지정한 데이터를 전송할 데이터로 덮어쓴다    |

HTTP 응답

| 상태 코드 |                               의미                                |
| :-------: | :---------------------------------------------------------------: |
|    1xx    |               정보, 추가 정보가 있다는 것을 알린다                |
|    2xx    |       성공, 서버가 요청을 성공적으로 처리했다는 것을 알린다       |
|    3xx    |       리다이렉트, 다른 URI로 다시 요청을 보낼 것을 요구한다       |
|    4xx    | 클라이언트 에러, 요청에 문제가 있어 처리하지 못했다는 것을 알린다 |
|    5xx    |  서버 에러, 서버 쪽에 문제가 있어 처리하지 못했다는 것을 알린다   |

```
HTTP 쿠키
=> 웹 서버가 웹 브라우저에 특정한 정보를 저장해두기 위한 시스템

장점1. 유저의 로그인 정보나 사이트 내 웹 페이지의 열람 이력 등을 관리할 수 있음, 더 나아가서는 접속한 유저에 따라 웹 페이지의 내용을 커스터마이즈 할 수 있게 됨
(ex. 과거 검색했던 것과 비슷한 상품 보여주기)

장점2. 접속했던 곳을 식별할 수 있게 됨 (웹 페이지 여러 개에 걸쳐서 일련의 처리를 수행하는 것이 가능해짐) = 접속 상태 보존 = 스테이트풀 (stateful)

```

### 02. 메일을 주고받아보자

### 02-1. 이메일 시스템

```
이메일 송수신의 개요

이메일 송수신 > SMTP, POP3라는 2개의 프로토콜을 조합하여 사용함
( SMTP : 메일 송신을 위한 프로토콜 / POP3 : 메일 서버로부터 자기 앞으로 온 메일을 수신하기 위한 프로토콜 )

(1) 이메일을 송신하면 메일 데이터는 SMTP에 의해 사전에 설정된 메일 서버로 보내짐
(2) 메일 데이터를 수신한 메일 서버는 받는 사람의 메일 주소 도메인으로부터 목적지 메일 서버 판단
(3) SMTP로 목적지 메일 서버에 메일 전송
(4) 목적지 메일 서버에서는 받는 사람의 메일 주소 ID를 보고 각 유저의 편지함에 메일을 저장함
(5) 메일을 수신할 유저는 자기 메일 서버의 편지함에 메일이 와 있는지 확인
(6) 만약 메일이 와 있다면, POP3로 자기 컴퓨터에 메일을 다운로드하고 메일을 읽음

```

주요 SMTP 명령어

| SMTP 명령어 |                  의미                  |
| :---------: | :------------------------------------: |
|    HELO     |               세션 시작                |
|    EHLO     |          세션 시작(확장 SMTP)          |
|    MAIL     |            송신자를 알린다             |
|    RCPT     |            수신자를 알린다             |
|    DATA     |          메일 데이터를 보낸다          |
|    QUIT     |               세션 종료                |
|    RSET     | 통신을 중단하고 받은 데이터를 파기한다 |
|    VERY     |            유저 아이디 확인            |
|    NOOP     |          아무것도 하지 않는다          |

주요 POP3 명령어

| POP3 명령어 |               의미               |
| :---------: | :------------------------------: |
|    USER     |       유저 아이디를 보낸다       |
|    PASS     |        패스워드를 보낸다         |
|    APOP     |   패스워드를 암호화해서 보낸다   |
|    AUTH     |       인증 방식을 통지한다       |
|    STAT     |      서버의 상태를 나타낸다      |
|    LIST     |       메일 알람을 나타낸다       |
|    RETR     |         메일을 요구한다          |
|    DELE     |         삭제 표시를 한다         |
|    RSET     |      DELE 커맨드 실행 취소       |
|    UIDL     | 메일의 유니크 ID 정보를 가져온다 |

```
POP3 메일 수신의 단점
1. 메일의 데이터를 PC에서 관리해야만 한다
2. 어느 PC에서든 한 번 메일을 수신하고 나면, 그 데이터는 서버에서 삭제됨 (일정 기간 남겨둘 수 있지만 대부분 삭제)
즉, 어느 PC에서 메일을 한 번 받고 나면 다른 PC에서는 그 메일을 받을 수 없게 된다는 것 (메일 데이터를 동기화 하는 것이 불가능함)

=> 그래서 사용하는 것이 'IMAP4' 프로토콜
```

> 'IMAP4' 프로토콜  
> 메일 서버에서 메일 데이터를 관리함 (로컬 PC에 의존하지 않고 어느 PC에서도 같은 메일을 읽을 수 있게 됨)
> 단점 : 메일 서버에 연결하지 못 하면 메일을 읽을 수 없음, 메일 서버의 부하가 큼 (개인을 상대로 하는 인터넷 접속 서비스의 메일 서버는 IMAP4를 지원하지 않는 경우가 많음)

### 02-1-1. 웹 메일이란?

SMTP/POP를 사용하지 않는 서비스, 이메일 소프트웨어를 사용하지 않고 웹 브라우저에서 메일을 송수신 할 수 있게해주는 서비스

웹 메일의 2가지 종류

-   ISP가 제공하는 웹 메일
    -   ISP와 인터넷 계약을 맺을 때 부가 서비스로 제공되기 때문에 계약한 사용자만 사용 가능
-   ISP 외의 인터넷 서비스 기업이 제공하는 웹 메일 (ex. 구글의 Gmail, 네이버의 네이버 메일 등)
    -   인터넷 접속만 가능하다면 누구나 서비스 이용 가능 + 매우 큰 디스크 용량 제공

*   추가적으로는 IMAP4 서버를 이용하여 이메일 소프트웨어로 웹 메일을 송수신하게 해주는 서비스도 존재

### 02-2. 이메일 보안

SMTP/POP3의 보안 (약함)

-   SMTP 보안 : 메일 서버에 메일을 송신할 경우 인증 등의 절차를 거치지 않음, 메일의 암호화나 변조 여부 또한 체크하지 않음
-   POP3 보안 : 유저 인증은 이루어지지만, 인증 패스워드의 암호화나 메일 내용의 암호화 안됨

> 이메일 보안을 강화하기 위한 다양한 기능들  
> 이메일 송신 보안
>
> -   Outbound Port 25 Blocking(OP25B)
> -   SMTP Authentication(SMTP Auth)
> -   SMTP over SSL
>
> 이메일 수신 보안
>
> -   APOP
> -   POP3 over SSL
>
> 이메일 본문 보안
>
> -   PGP
> -   S/MINE
